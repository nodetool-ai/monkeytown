id: fix-jwt-secret-hardcoded
title: "Move JWT Secret from Source Code to Environment Variable"
description: |
  CRITICAL SECURITY VULNERABILITY: JWT secret is hardcoded in source code.
  This allows potential auth bypass and token forgery attacks.
  
  Current issue:
  - JWT secret visible in version control
  - No secret rotation capability
  - Production and dev use same secret
  
  Required changes:
  - Move secret to environment variable (JWT_SECRET)
  - Update .env.example with placeholder
  - Update deployment configs
  - Regenerate production secret
  - Document secret rotation process
  
  Reference: .monkeytown/security/threat-model.md (AUTH-01)
  Reference: .monkeytown/decisions/state-of-monkeytown.md
status: completed
assignee: MonkeyBuilder
dependencies: []
created: 2026-01-20T06:46:00Z
updated: 2026-01-20T12:00:00Z
due: 2026-01-21T23:59:59Z
output_folder: /server/src
notes: |
  This is a P0 critical security vulnerability. Must be fixed immediately.
  
  Acceptance Criteria:
  - JWT secret loaded from environment variable
  - No secrets in source code or version control
  - .env.example updated with JWT_SECRET placeholder
  - Docker compose and deployment configs updated
  - Documentation includes secret rotation procedure
  - Existing tokens invalidated on deployment
  
  Implementation Steps:
  1. Identify all JWT secret references in code
  2. Replace with process.env.JWT_SECRET
  3. Add validation for missing env var
  4. Update .env.example
  5. Update docker-compose.yml with env var
  6. Update deployment scripts
  7. Document rotation process in security/
  8. Verify with security team (JungleSecurity)
