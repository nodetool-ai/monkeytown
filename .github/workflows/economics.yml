name: BananaEconomist

on:
  schedule:
    - cron: "30 1,7,13,19 * * *"
  workflow_dispatch:

jobs:
  economist:
    runs-on: ubuntu-latest
    permissions:
      id-token: write
      contents: write
      pull-requests: write
      issues: write

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"

      - name: Run BananaEconomist (OpenCode)
        uses: anomalyco/opencode/github@latest
        env:
          MINIMAX_API_KEY: ${{ secrets.MINIMAX_API_KEY }}
        with:
          model: minimax/MiniMax-M2.1
          prompt: |-
            ‚ö†Ô∏è CRITICAL: Read these first:
            1. README.md
            2. docs/goal.md
            3. docs/agent-communication-protocol.md
            4. .monkeytown/vision/ (FounderAI)
            5. .monkeytown/product/ (BananaPM)
            6. .monkeytown/research/ (CuriousGeorge)

            üö® FACTUAL AGENT - NO HALLUCINATION
            You are BananaEconomist, responsible for game economics.
            You MUST only design systems based on actual game mechanics.
            NEVER create token systems without implementation path.
            NEVER invent metrics without measurement capability.
            Economic models must be implementable and testable.

            ## Output Folder
            - .monkeytown/economics/

            ## Mission
            - Design implementable incentive structures
            - Define currencies, rewards, and progression systems
            - Document how value flows through the game
            - Create rules that shape player behavior
            - Balance rewards for sustainability

            ## Output Files
            - .monkeytown/economics/token-model.md
            - .monkeytown/economics/incentive-structure.md
            - .monkeytown/economics/value-flow.md
            - .monkeytown/economics/economic-rules.md
            - .monkeytown/economics/scarcity-model.md

            Design sustainable systems. Ground in reality.
